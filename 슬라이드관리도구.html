<!DOCTYPE html>
<html lang="ko">
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¬ë¼ì´ë“œ ê´€ë¦¬ ë„êµ¬</title>
    <link rel="stylesheet" href="styles/admin.css">

</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1>ìŠ¬ë¼ì´ë“œ ê´€ë¦¬ ë„êµ¬</h1>
        </div>
        
        <div class="main-content">
            <!-- ì™¼ìª½ ì»¬ëŸ¼: ì´ë¯¸ì§€ ëª©ë¡ -->
            <div class="left-column">
                <!-- ì´ë¯¸ì§€ ëª©ë¡ -->
                <div class="panel">
                    <div class="panel-header">
                        <h2 class="panel-title">
                            ì´ë¯¸ì§€ ëª©ë¡
                        </h2>
                        <div class="header-buttons">
                            <button class="action-btn info" id="helpBtn" onclick="toggleHelp()" title="ì‚¬ìš©ë²• ë° í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤ ë³´ê¸°">
                                <span style="font-size: 16px;">â„¹ï¸</span> ì •ë³´
                            </button>
                            <button class="action-btn secondary" id="selectDirectoryBtn">ê¶Œí•œ ìŠ¹ì¸</button>
                            <button class="action-btn primary" id="refreshImagesBtn" onclick="refreshImages()" style="display: none;">ìƒˆë¡œê³ ì¹¨</button>
                            <button class="action-btn warning" onclick="resetConfig()">ì´ˆê¸°í™”</button>
                        </div>
                    </div>
                    
                    <!-- ë„ì›€ë§ ë©”ì‹œì§€ -->
                    <div class="help-message" id="helpMessage" style="display: none;">
                        <div style="padding: 16px; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 8px; margin: 10px 0; font-size: 14px; color: #495057; line-height: 1.6;">
                            <div style="margin-bottom: 16px;">
                                <strong style="color: #007bff; font-size: 16px;">ê´€ë¦¬ ë„êµ¬ ì‚¬ìš©ë²•</strong>
                                <br><br>
                                <strong>ê¸°ë³¸ ì„¤ì •:</strong>
                                <br>1. 'ê¶Œí•œ ìŠ¹ì¸' ë²„íŠ¼ í´ë¦­í•˜ì—¬ í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ <strong>images</strong> í´ë” ì„ íƒ
                                <br>2. 'ìƒˆë¡œê³ ì¹¨' ë²„íŠ¼ìœ¼ë¡œ images í´ë”ì˜ ìµœì‹  ìƒíƒœ ë°˜ì˜
                                <br>3. ì´ë¯¸ì§€ ì¶”ê°€ëŠ” ì§ì ‘ images í´ë”ì— íŒŒì¼ì„ ë³µì‚¬í•œ í›„ ìƒˆë¡œê³ ì¹¨
                            </div>
                            
                            <div style="border-top: 1px solid #dee2e6; padding-top: 16px;">
                                <strong style="color: #007bff; font-size: 16px;">ìŠ¬ë¼ì´ë“œ í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤</strong>
                                <br><br>
                                <div style="display: grid; grid-template-columns: auto 1fr; gap: 8px; margin-left: 16px;">
                                    <span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 4px; font-family: monospace; font-size: 12px; text-align: center; min-width: 60px;">â†</span>
                                    <span>ì´ì „ ì´ë¯¸ì§€ë¡œ ì´ë™</span>
                                    
                                    <span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 4px; font-family: monospace; font-size: 12px; text-align: center; min-width: 60px;">â†’</span>
                                    <span>ë‹¤ìŒ ì´ë¯¸ì§€ë¡œ ì´ë™</span>
                                    
                                    <span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 4px; font-family: monospace; font-size: 12px; text-align: center; min-width: 60px;">Space</span>
                                    <span>ìŠ¬ë¼ì´ë“œ ì¬ìƒ/ì¼ì‹œì •ì§€</span>
                                    
                                    <span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 4px; font-family: monospace; font-size: 12px; text-align: center; min-width: 60px;">?</span>
                                    <span>ìŠ¬ë¼ì´ë“œì—ì„œ ë„ì›€ë§ í‘œì‹œ/ìˆ¨ê¹€</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- í†µê³„ ì •ë³´ -->
                    <div class="stats-summary">
                        <div class="stat-content">
                            <span class="stat-label">ì´ ì´ë¯¸ì§€:</span>
                            <span class="stat-value" id="totalImages">0</span>
                        </div>
                        <div class="stat-content">
                            <span class="stat-label">í™œì„± ì´ë¯¸ì§€:</span>
                            <span class="stat-value" id="activeImages">0</span>
                        </div>
                        <div class="stat-item">
                            <button class="action-btn primary" id="openSlideBtn" onclick="openFullSlide()">ìŠ¬ë¼ì´ë“œ ì—´ê¸°</button>
                        </div>
                    </div>
                    
                    <div class="image-list" id="imageList">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                    </div>
                </div>
            </div>
            
            <!-- ì˜¤ë¥¸ìª½ ì»¬ëŸ¼: ìŠ¬ë¼ì´ë“œ ì„¤ì • -->
            <div class="right-column">
                <!-- ì„¤ì • -->
                <div class="panel">
                    <h2 class="panel-title">
                        ìŠ¬ë¼ì´ë“œ ì„¤ì •
                    </h2>
                    
                    <div class="setting-group checkbox-group">
                        <label class="setting-label">
                            <input type="checkbox" id="autoPlay" checked> ìë™ ì¬ìƒ
                        </label>
                        <label class="setting-label">
                            <input type="checkbox" id="showControls" checked> ì»¨íŠ¸ë¡¤ ë²„íŠ¼
                        </label>
                        <label class="setting-label">
                            <input type="checkbox" id="showIndicators" checked> ì¸ë””ì¼€ì´í„°
                        </label>
                    </div>
                    
                    <div class="setting-group dual-range-group">
                        <div class="range-item">
                            <label class="setting-label">ìë™ ì „í™˜ ê°„ê²© (ì´ˆ)</label>
                            <input type="range" class="setting-range" id="slideInterval" 
                                   min="1" max="10" step="0.5" value="3">
                            <div class="range-display" id="slideIntervalDisplay">3ì´ˆ</div>
                        </div>
                        <div class="range-item">
                            <label class="setting-label">ì „í™˜ íš¨ê³¼ ì‹œê°„ (ì´ˆ)</label>
                            <input type="range" class="setting-range" id="transitionDuration" 
                                   min="0.3" max="2" step="0.1" value="0.8">
                            <div class="range-display" id="transitionDurationDisplay">0.8ì´ˆ</div>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">ì• ë‹ˆë©”ì´ì…˜ íƒ€ì…</label>
                        <select class="setting-input" id="animationType">
                            <option value="scroll" selected>ë¬´í•œ ìŠ¤í¬ë¡¤</option>
                            <option value="fade">í˜ì´ë“œ ì¸/ì•„ì›ƒ</option>
                        </select>
                    </div>
                    
                    
                    <div class="setting-group">
                        <label class="setting-label">ì´ë¯¸ì§€ í‘œì‹œ ë°©ì‹</label>
                        <select class="setting-input" id="imageResize">
                            <option value="contain">ì „ì²´ ì´ë¯¸ì§€ ë³´ê¸°</option>
                            <option value="cover">í™”ë©´ ì±„ìš°ê¸°</option>
                            <option value="fill">í™”ë©´ ë§ì¶¤</option>
                            <option value="scale-down">ì¶•ì†Œë§Œ í—ˆìš©</option>
                            <option value="none">ì›ë³¸ í¬ê¸°</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">ì´ë¯¸ì§€ ìœ„ì¹˜</label>
                        <select class="setting-input" id="objectPosition">
                            <option value="center">ì¤‘ì•™</option>
                            <option value="top">ìƒë‹¨</option>
                            <option value="bottom">í•˜ë‹¨</option>
                            <option value="left">ì™¼ìª½</option>
                            <option value="right">ì˜¤ë¥¸ìª½</option>
                            <option value="top left">ì™¼ìª½ ìƒë‹¨</option>
                            <option value="top right">ì˜¤ë¥¸ìª½ ìƒë‹¨</option>
                            <option value="bottom left">ì™¼ìª½ í•˜ë‹¨</option>
                            <option value="bottom right">ì˜¤ë¥¸ìª½ í•˜ë‹¨</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">ë°°ê²½ìƒ‰</label>
                        <div class="color-input-group">
                            <input type="color" class="setting-input" id="backgroundColor" value="#000000">
                            <span class="color-value" id="backgroundColorValue">#000000</span>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">ìŠ¬ë¼ì´ë“œ í¬ê¸°</label>
                        <div class="size-inputs">
                            <div class="size-input-group">
                                <label class="size-label">ë„ˆë¹„</label>
                                <input type="number" class="setting-input size-input" id="containerWidth" 
                                       min="200" max="3840" step="1" value="600">
                            </div>
                            <div class="size-input-group">
                                <label class="size-label">ë†’ì´</label>
                                <input type="number" class="setting-input size-input" id="containerHeight" 
                                       min="150" max="2160" step="1" value="800">
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">ë¸Œë¼ìš°ì € ì°½ ì—¬ë°±</label>
                        <div class="size-inputs">
                            <div class="size-input-group">
                                <label class="size-label">ì¢Œìš°</label>
                                <input type="number" class="setting-input size-input" id="extraWidth" 
                                       min="0" max="200" step="1" value="0">
                            </div>
                            <div class="size-input-group">
                                <label class="size-label">ìƒí•˜</label>
                                <input type="number" class="setting-input size-input" id="extraHeight" 
                                       min="0" max="200" step="1" value="40">
                            </div>
                        </div>
                        <div class="setting-description">
                            ë¸Œë¼ìš°ì € ì°½ì„ ì—´ ë•Œ ì¶”ê°€í•  ì—¬ë°± (px)
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div>ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...</div>
        </div>
    </div>
    
    <!-- ë¸Œë¼ìš°ì € ë¹„ì§€ì› ì˜¤ë²„ë ˆì´ -->
    <div class="browser-unsupported-overlay hidden" id="browserUnsupportedOverlay">
        <div class="unsupported-content">
            <div class="unsupported-icon">ğŸŒ</div>
            <div class="unsupported-title">ë¸Œë¼ìš°ì €ê°€ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤</div>
            <div class="unsupported-message">
                ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ <strong>File System Access API</strong>ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.<br>
                í˜„ì¬ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì´ ê¸°ëŠ¥ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </div>
            <div class="recommended-browsers">
                <div class="browsers-title">ê¶Œì¥ ë¸Œë¼ìš°ì €:</div>
                <div class="browser-list">
                    <div class="browser-item">
                        <span class="browser-icon">ğŸŸ¢</span>
                        <span class="browser-name">Google Chrome</span>
                    </div>
                </div>
            </div>
            <div class="unsupported-note">
                <strong>ì°¸ê³ :</strong> ê¶Œì¥ ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
            </div>
            <div class="unsupported-actions">
                <button class="error-btn" onclick="window.location.reload()">ìƒˆë¡œê³ ì¹¨</button>
                <button class="error-btn secondary" onclick="window.close()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
    
    <!-- ì•Œë¦¼ -->
    <div class="notification" id="notification">
        <span id="notificationText"></span>
    </div>
    
    <!-- ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ -->
    <input type="file" id="importInput" accept=".json" style="display: none;">

    <script src="config-manager.js"></script>
    <script>
        class AdminApp {
            constructor() {
                this.configManager = null;
                this.init();
            }

            async init() {
                // ë¸Œë¼ìš°ì € ì§€ì› ì—¬ë¶€ ë¨¼ì € ì²´í¬
                if (!this.checkBrowserSupport()) {
                    return; // ì§€ì›ë˜ì§€ ì•Šìœ¼ë©´ ì´ˆê¸°í™” ì¤‘ë‹¨
                }
                
                try {
                    this.showLoading();
                    
                    // ConfigManager ì´ˆê¸°í™”
                    this.configManager = new ConfigManager();
                    await this.waitForConfig();
                    
                    // í´ë” ê¶Œí•œ ê²€ì¦ (ê¶Œí•œ ìƒì‹¤ ì‹œ ìë™ ì •ë¦¬)
                    if (this.configManager.hasDirectoryAccess()) {
                        const isValid = await this.configManager.validateDirectoryAccess();
                        if (!isValid) {
                            console.log("ğŸ”„ í´ë” ê¶Œí•œì´ ìƒì‹¤ë˜ì–´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤");
                            this.showNotification('í´ë” ì ‘ê·¼ ê¶Œí•œì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í´ë”ë¥¼ ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.', 'warning');
                        }
                    }
                    
                    // UI ì´ˆê¸°í™”
                    this.setupEventListeners();
                    this.loadSettings();
                    await this.loadImageList();
                    this.updateStats();
                    this.updateDirectoryStatus(); // ê¶Œí•œ ê²€ì¦ í›„ ë””ë ‰í† ë¦¬ ìƒíƒœ ì—…ë°ì´íŠ¸
                    
                    this.hideLoading();
                    
                    // í´ë”ê°€ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ ì„±ê³µ ë©”ì‹œì§€, ì•„ë‹ˆë©´ ì•ˆë‚´ ë©”ì‹œì§€
                    if (this.configManager.hasDirectoryAccess()) {
                        const folderName = this.configManager.getDirectoryName();
                        const images = this.configManager.getImages();
                        this.showNotification(`images í´ë” ê¶Œí•œì´ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤! (${folderName})\nğŸ“· ${images.length}ê°œ ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    } else {
                        this.showNotification('ë¨¼ì € í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'info');
                    }
                    
                } catch (error) {
                    console.error('ì•± ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                    this.hideLoading();
                    this.showNotification('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            checkBrowserSupport() {
                const isSupported = 'showOpenFilePicker' in window && 'showDirectoryPicker' in window;
                
                if (!isSupported) {
                    console.warn('âŒ File System Access APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤');
                    this.showBrowserUnsupportedOverlay();
                    this.disableInterface();
                    return false;
                }
                
                console.log('âœ… File System Access API ì§€ì› ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤');
                return true;
            }

            showBrowserUnsupportedOverlay() {
                const overlay = document.getElementById('browserUnsupportedOverlay');
                overlay.classList.remove('hidden');
            }

            hideBrowserUnsupportedOverlay() {
                const overlay = document.getElementById('browserUnsupportedOverlay');
                overlay.classList.add('hidden');
            }

            disableInterface() {
                // ëª¨ë“  ìƒí˜¸ì‘ìš© ìš”ì†Œ ë¹„í™œì„±í™”
                const interactiveElements = document.querySelectorAll('button, input, select, textarea');
                interactiveElements.forEach(element => {
                    element.disabled = true;
                    element.classList.add('disabled');
                });

                // ë©”ì¸ ì»¨í…Œì´ë„ˆ íˆ¬ëª…ë„ ì¡°ì ˆ
                const container = document.querySelector('.container');
                if (container) {
                    container.style.opacity = '0.5';
                    container.style.pointerEvents = 'none';
                }
            }

            async waitForConfig() {
                return new Promise((resolve) => {
                    const checkConfig = () => {
                        if (this.configManager.getConfig()) {
                            resolve();
                        } else {
                            setTimeout(checkConfig, 100);
                        }
                    };
                    checkConfig();
                });
            }

            setupEventListeners() {
                // ì„¤ì • ë³€ê²½ ì´ë²¤íŠ¸ë“¤
                document.getElementById('slideInterval').addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    document.getElementById('slideIntervalDisplay').textContent = `${value}ì´ˆ`;
                    this.configManager.updateSetting('slideInterval', value * 1000);
                });

                document.getElementById('transitionDuration').addEventListener('input', (e) => {
                    const value = parseFloat(e.target.value);
                    document.getElementById('transitionDurationDisplay').textContent = `${value}ì´ˆ`;
                    this.configManager.updateSetting('transitionDuration', value * 1000);
                });

                document.getElementById('animationType').addEventListener('change', (e) => {
                    this.configManager.updateSetting('animationType', e.target.value);
                });

                document.getElementById('autoPlay').addEventListener('change', (e) => {
                    this.configManager.updateSetting('autoPlay', e.target.checked);
                });

                document.getElementById('showControls').addEventListener('change', (e) => {
                    this.configManager.updateSetting('showControls', e.target.checked);
                });

                document.getElementById('showIndicators').addEventListener('change', (e) => {
                    this.configManager.updateSetting('showIndicators', e.target.checked);
                });

                document.getElementById('imageResize').addEventListener('change', (e) => {
                    this.configManager.updateSetting('imageResize', e.target.value);
                });

                document.getElementById('objectPosition').addEventListener('change', (e) => {
                    this.configManager.updateSetting('objectPosition', e.target.value);
                });

                document.getElementById('backgroundColor').addEventListener('change', (e) => {
                    this.configManager.updateSetting('backgroundColor', e.target.value);
                    document.getElementById('backgroundColorValue').textContent = e.target.value.toUpperCase();
                });

                document.getElementById('containerWidth').addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    if (value >= 200 && value <= 3840) {
                        this.configManager.updateSetting('containerWidth', `${value}px`);
                    }
                });

                document.getElementById('containerHeight').addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    if (value >= 150 && value <= 2160) {
                        this.configManager.updateSetting('containerHeight', `${value}px`);
                    }
                });

                document.getElementById('extraWidth').addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    if (value >= 0 && value <= 200) {
                        this.configManager.updateSetting('extraWidth', value);
                    }
                });

                document.getElementById('extraHeight').addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    if (value >= 0 && value <= 200) {
                        this.configManager.updateSetting('extraHeight', value);
                    }
                });

                // ì„¤ì • ë³€ê²½ ê°ì§€ (throttled)
                let updateStatsTimeout = null;
                this.configManager.addEventListener('configChanged', () => {
                    if (updateStatsTimeout) {
                        clearTimeout(updateStatsTimeout);
                    }
                    updateStatsTimeout = setTimeout(() => {
                        this.updateStats();
                    }, 100);
                });

                // config.json íŒŒì¼ ìë™ ë¦¬ë¡œë“œ ê°ì§€
                this.configManager.addEventListener('configReloaded', () => {
                    console.log('ğŸ”„ config.json ìë™ ë¦¬ë¡œë“œ ê°ì§€ - UI ì—…ë°ì´íŠ¸ ì¤‘...');
                    this.handleConfigReload();
                });

                // ê°€ì ¸ì˜¤ê¸° íŒŒì¼ ì…ë ¥
                document.getElementById('importInput').addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.handleImport(e.target.files[0]);
                    }
                });

                // ë””ë ‰í† ë¦¬ ì„ íƒ ë²„íŠ¼ë“¤
                document.getElementById('selectDirectoryBtn').addEventListener('click', () => {
                    this.selectDirectory();
                });
            }

            updateLoadingMessage(message) {
                const loadingContent = document.querySelector('.loading-content div:last-child');
                if (loadingContent) {
                    loadingContent.style.whiteSpace = 'pre-line';
                    loadingContent.textContent = message;
                }
            }

            loadSettings() {
                const settings = this.configManager.getSettings();
                
                document.getElementById('slideInterval').value = settings.slideInterval / 1000;
                document.getElementById('slideIntervalDisplay').textContent = `${settings.slideInterval / 1000}ì´ˆ`;
                
                document.getElementById('transitionDuration').value = settings.transitionDuration / 1000;
                document.getElementById('transitionDurationDisplay').textContent = `${settings.transitionDuration / 1000}ì´ˆ`;
                
                document.getElementById('autoPlay').checked = settings.autoPlay;
                document.getElementById('animationType').value = settings.animationType || 'scroll';
                document.getElementById('showControls').checked = settings.showControls;
                document.getElementById('showIndicators').checked = settings.showIndicators;
                document.getElementById('imageResize').value = settings.imageResize;
                document.getElementById('objectPosition').value = settings.objectPosition || 'center';
                document.getElementById('backgroundColor').value = settings.backgroundColor;
                document.getElementById('backgroundColorValue').textContent = settings.backgroundColor.toUpperCase();
                
                // í¬ê¸° ì„¤ì • ë¡œë“œ (px ê°’ì—ì„œ ìˆ«ìë§Œ ì¶”ì¶œ)
                const widthValue = parseInt(settings.containerWidth.replace('px', '')) || 600;
                const heightValue = parseInt(settings.containerHeight.replace('px', '')) || 800;
                document.getElementById('containerWidth').value = widthValue;
                document.getElementById('containerHeight').value = heightValue;
                
                // ë¸Œë¼ìš°ì € ì—¬ë°± ì„¤ì • ë¡œë“œ
                document.getElementById('extraWidth').value = settings.extraWidth || 0;
                document.getElementById('extraHeight').value = settings.extraHeight || 40;
            }

            async loadImageList() {
                const images = this.configManager.getImages();
                const container = document.getElementById('imageList');

                // ê° ì´ë¯¸ì§€ì˜ ì‹¤ì œ ë°ì´í„°ë¥¼ ë¹„ë™ê¸°ë¡œ ë¡œë“œ
                const imageElements = await Promise.all(images
                    .sort((a, b) => a.order - b.order)
                    .map(async (image) => {
                        // ConfigManagerì˜ getImageDataë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¬ë°”ë¥¸ ê²½ë¡œ ë˜ëŠ” ë°ì´í„° ì–»ê¸°
                        const imageSrc = await this.configManager.getImageData(image.path);
                        
                        return `
                            <div class="image-item ${!image.enabled ? 'disabled' : ''}" data-id="${image.id}">
                                <img src="${imageSrc}" alt="${image.alt}" class="image-preview" loading="lazy">
                                <div class="image-info">
                                    <div class="image-name">${image.filename}</div>
                                    <div class="image-meta">ìˆœì„œ: ${image.order} â€¢ ì¶”ê°€ì¼: ${new Date(image.addedDate).toLocaleDateString()}</div>
                                </div>
                                <div class="image-controls">
                                    <input type="number" class="order-input" value="${image.order}" 
                                           min="1" max="${images.length}" 
                                           onchange="app.updateImageOrder(${image.id}, this.value)">
                                    <div class="toggle-switch ${image.enabled ? 'active' : ''}" 
                                         onclick="app.toggleImageEnabled(${image.id})"></div>
                                    <button class="btn" onclick="app.moveImageUp(${image.id})" title="ìœ„ë¡œ">â†‘</button>
                                    <button class="btn" onclick="app.moveImageDown(${image.id})" title="ì•„ë˜ë¡œ">â†“</button>
                                    <button class="btn danger" onclick="app.removeImage(${image.id})" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                                </div>
                            </div>
                        `;
                    })
                );

                container.innerHTML = imageElements.join('');
            }

            // ë¶€ë¶„ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ìµœì í™”ëœ ë©”ì„œë“œ
            updateImageItem(imageId) {
                const images = this.configManager.getImages();
                const image = images.find(img => img.id === imageId);
                if (!image) return;

                const imageItem = document.querySelector(`[data-id="${imageId}"]`);
                if (imageItem) {
                    // ìƒíƒœ ì—…ë°ì´íŠ¸
                    imageItem.className = `image-item ${!image.enabled ? 'disabled' : ''}`;
                    
                    // í† ê¸€ ìŠ¤ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                    const toggle = imageItem.querySelector('.toggle-switch');
                    toggle.className = `toggle-switch ${image.enabled ? 'active' : ''}`;
                    
                    // ìˆœì„œ ì…ë ¥ í•„ë“œ ì—…ë°ì´íŠ¸
                    const orderInput = imageItem.querySelector('.order-input');
                    orderInput.value = image.order;
                    orderInput.max = images.length;
                    
                    // ë©”íƒ€ ì •ë³´ ì—…ë°ì´íŠ¸
                    const metaDiv = imageItem.querySelector('.image-meta');
                    metaDiv.textContent = `ìˆœì„œ: ${image.order} â€¢ ì¶”ê°€ì¼: ${new Date(image.addedDate).toLocaleDateString()}`;
                }
            }

            async updateImageOrder(imageId, newOrder) {
                const images = this.configManager.getImages();
                const order = Math.max(1, Math.min(parseInt(newOrder), images.length));
                
                if (this.configManager.updateImageOrder(imageId, order)) {
                    // ìˆœì„œ ë³€ê²½ì€ ì „ì²´ ë¦¬ë¡œë“œê°€ í•„ìš” (DOM ìˆœì„œê°€ ë°”ë€Œì–´ì•¼ í•¨)
                    await this.loadImageList();
                    this.showNotification('ìˆœì„œê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                }
            }

            async toggleImageEnabled(imageId) {
                const image = this.configManager.getImages().find(img => img.id === imageId);
                if (image) {
                    this.configManager.updateImageEnabled(imageId, !image.enabled);
                    this.updateImageItem(imageId); // ë¶€ë¶„ ì—…ë°ì´íŠ¸ë§Œ ìˆ˜í–‰
                    this.updateStats(); // í†µê³„ë§Œ ì—…ë°ì´íŠ¸
                    this.showNotification(
                        !image.enabled ? 'ì´ë¯¸ì§€ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ì´ë¯¸ì§€ê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.',
                        'success'
                    );
                }
            }

            async moveImageUp(imageId) {
                const image = this.configManager.getImages().find(img => img.id === imageId);
                if (image && image.order > 1) {
                    await this.updateImageOrder(imageId, image.order - 1);
                }
            }

            async moveImageDown(imageId) {
                const images = this.configManager.getImages();
                const image = images.find(img => img.id === imageId);
                if (image && image.order < images.length) {
                    await this.updateImageOrder(imageId, image.order + 1);
                }
            }

            async removeImage(imageId) {
                if (confirm('ì´ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    this.showLoading();
                    try {
                        const removed = await this.configManager.removeImage(imageId);
                        if (removed) {
                            await this.loadImageList();
                            this.showNotification('ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\nğŸ’¾ ì‹¤ì œ íŒŒì¼ë„ í•¨ê»˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        }
                    } catch (error) {
                        console.error('ì´ë¯¸ì§€ ì‚­ì œ ì‹¤íŒ¨:', error);
                        this.showNotification('ì´ë¯¸ì§€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                    this.hideLoading();
                }
            }

            updateStats() {
                const images = this.configManager.getImages();
                const activeImages = this.configManager.getActiveImages();
                
                document.getElementById('totalImages').textContent = images.length;
                document.getElementById('activeImages').textContent = activeImages.length;
            }

            showLoading() {
                document.getElementById('loadingOverlay').classList.add('show');
            }

            hideLoading() {
                document.getElementById('loadingOverlay').classList.remove('show');
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                const text = document.getElementById('notificationText');
                
                text.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            // ì „ì—­ í•¨ìˆ˜ë“¤
            exportConfig() {
                this.configManager.exportConfig();
                this.showNotification('ì„¤ì •ì´ ë‚´ë³´ë‚´ê¸° ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            }

            async saveToFile() {
                this.showLoading();
                
                try {
                    const success = await this.configManager.saveToFileExplicit();
                    if (success) {
                        this.showNotification('íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    } else {
                        this.showNotification('ì €ì¥ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'warning');
                    }
                } catch (error) {
                    this.showNotification('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
                
                this.hideLoading();
            }

            importConfig() {
                document.getElementById('importInput').click();
            }

            async handleImport(file) {
                this.showLoading();
                
                try {
                    const success = await this.configManager.importConfig(file);
                    if (success) {
                        this.loadSettings();
                        await this.loadImageList();
                        this.showNotification('ì„¤ì •ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.', 'success');
                    } else {
                        this.showNotification('ì„¤ì • ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                } catch (error) {
                    this.showNotification('íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                }
                
                this.hideLoading();
            }

            async selectDirectory() {
                try {
                    if (!this.configManager.isFileSystemSupported()) {
                        this.showNotification('ì´ ë¸Œë¼ìš°ì €ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'warning');
                        return;
                    }

                    // í´ë” ë³€ê²½ ì œí•œ í™•ì¸
                    if (!this.configManager.canChangeDirectory()) {
                        this.showNotification(
                            'ğŸ”’ í´ë” ë³€ê²½ì´ ì œí•œë©ë‹ˆë‹¤!\n\n' +
                            'ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ ì˜¬ë°”ë¥¸ í”„ë¡œì íŠ¸ images í´ë”ê°€ ì´ë¯¸ ì„ íƒëœ ê²½ìš°\n' +
                            'ë‹¤ë¥¸ í´ë”ë¡œ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                            'ğŸ’¡ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.',
                            'warning'
                        );
                        return;
                    }

                    this.showLoading();
                    this.updateLoadingMessage('í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”...');

                    const result = await this.configManager.requestImagesPermission();
                    
                    if (result.success) {
                        this.updateDirectoryStatus();
                        
                        // ìŠ¤ìº” ê²°ê³¼ ì²˜ë¦¬
                        const scanResult = result.scanResult;
                        let message = 'âœ… í”„ë¡œì íŠ¸ images í´ë”ê°€ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤!';
                        message += '\nğŸ”’ ë³´ì•ˆì„ ìœ„í•´ í´ë” ë³€ê²½ì´ ì œí•œë©ë‹ˆë‹¤.';
                        
                        if (scanResult) {
                            if (scanResult.added > 0) {
                                message += `\n\nğŸ“· ${scanResult.added}ê°œì˜ ê¸°ì¡´ ì´ë¯¸ì§€ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤!`;
                                if (scanResult.skipped > 0) {
                                    message += `\nâ­ï¸ ${scanResult.skipped}ê°œì˜ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ ëª©ë¡ì— ìˆì–´ì„œ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤.`;
                                }
                                
                                // ì´ë¯¸ì§€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                                await this.loadImageList();
                            } else if (scanResult.scanned > 0) {
                                message += '\n\nğŸ’¡ images í´ë”ê°€ ë¹„ì–´ìˆê±°ë‚˜ ëª¨ë“  ì´ë¯¸ì§€ê°€ ì´ë¯¸ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                            } else {
                                message += '\n\nğŸ’¡ images í´ë”ì— íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.';
                            }
                            
                            if (scanResult.error) {
                                message += `\nâš ï¸ ìŠ¤ìº” ì¤‘ ì¼ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${scanResult.error}`;
                            }
                        }
                        
                        this.showNotification(message, 'success');
                    } else {
                        if (result.error && result.error.name !== "AbortError") {
                            this.showNotification('images í´ë” ì„ íƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                        }
                    }
                } catch (error) {
                    console.error('images í´ë” ì„ íƒ ì‹¤íŒ¨:', error);
                    this.showNotification('images í´ë” ì„ íƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    this.hideLoading();
                }
            }

            updateDirectoryStatus() {
                const selectBtn = document.getElementById('selectDirectoryBtn');
                const refreshBtn = document.getElementById('refreshImagesBtn');
                const openSlideBtn = document.getElementById('openSlideBtn');
                const helpMessage = document.getElementById('helpMessage');

                if (this.configManager.hasDirectoryAccess()) {
                    // ê¶Œí•œ ìŠ¹ì¸ ë²„íŠ¼ ìˆ¨ê¹€, ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ í‘œì‹œ
                    selectBtn.style.display = 'none';
                    refreshBtn.style.display = 'inline-block';
                    
                    // ë„ì›€ë§ ìˆ¨ê¹€
                    helpMessage.style.display = 'none';
                    
                    // ìŠ¬ë¼ì´ë“œ ì—´ê¸° ë²„íŠ¼ í™œì„±í™”
                    openSlideBtn.classList.remove('disabled');
                    openSlideBtn.disabled = false;
                    openSlideBtn.title = 'ìŠ¬ë¼ì´ë“œ í™”ë©´ì„ ìƒˆ ì°½ìœ¼ë¡œ ì—½ë‹ˆë‹¤';
                } else {
                    // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ìˆ¨ê¹€, ê¶Œí•œ ìŠ¹ì¸ ë²„íŠ¼ í‘œì‹œ
                    selectBtn.style.display = 'inline-block';
                    refreshBtn.style.display = 'none';
                    selectBtn.textContent = 'ê¶Œí•œ ìŠ¹ì¸';
                    selectBtn.className = 'action-btn secondary';
                    selectBtn.disabled = false;
                    selectBtn.title = 'í”„ë¡œì íŠ¸ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                    
                    // ë„ì›€ë§ í‘œì‹œ
                    helpMessage.style.display = 'block';
                    
                    // ìŠ¬ë¼ì´ë“œ ì—´ê¸° ë²„íŠ¼ ë¹„í™œì„±í™”
                    openSlideBtn.classList.add('disabled');
                    openSlideBtn.disabled = true;
                    openSlideBtn.title = 'ë¨¼ì € í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                }
            }

            checkDirectoryAccess() {
                if (!this.configManager.hasDirectoryAccess()) {
                    this.showNotification('ë¨¼ì € í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!', 'warning');
                    return false;
                }
                return true;
            }

            async refreshImages() {
                if (!this.configManager.hasDirectoryAccess()) {
                    this.showNotification('í´ë” ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                    return;
                }

                this.showLoading();
                this.updateLoadingMessage('í´ë”ì™€ configë¥¼ ë™ê¸°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤...');

                try {
                    // í´ë”ì™€ configë¥¼ ì™„ì „íˆ ë™ê¸°í™” (ì¶”ê°€ + ì œê±°)
                    const syncResult = await this.configManager.syncImagesWithFolder();
                    
                    // ì´ë¯¸ì§€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    await this.loadImageList();
                    this.updateStats();
                    
                    let message = 'í´ë” ë™ê¸°í™” ì™„ë£Œ!';
                    if (syncResult.added > 0 || syncResult.removed > 0) {
                        if (syncResult.added > 0) {
                            message += `\nâ• ${syncResult.added}ê°œì˜ ìƒˆë¡œìš´ ì´ë¯¸ì§€ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                        }
                        if (syncResult.removed > 0) {
                            message += `\nğŸ—‘ï¸ ${syncResult.removed}ê°œì˜ ì‚­ì œëœ ì´ë¯¸ì§€ê°€ ëª©ë¡ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                        }
                    } else {
                        message += '\nâœ… í´ë”ì™€ ëª©ë¡ì´ ì´ë¯¸ ë™ê¸°í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                    }
                    
                    this.showNotification(message, 'success');
                } catch (error) {
                    console.error('í´ë” ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);
                    this.showNotification('í´ë” ìƒˆë¡œê³ ì¹¨ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    this.hideLoading();
                }
            }

            async resetConfig() {
                if (confirm('ëª¨ë“  ì„¤ì •ê³¼ ì´ë¯¸ì§€ ëª©ë¡ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì„¤ì •ë§Œ ì´ˆê¸°í™”ë˜ë©°, ì‹¤ì œ ì´ë¯¸ì§€ íŒŒì¼ì€ ì‚­ì œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')) {
                    this.showLoading();
                    this.updateLoadingMessage('ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤...');
                    
                    try {
                        // 1ë‹¨ê³„: config ì„¤ì •ë§Œ ì´ˆê¸°í™” (ì‹¤ì œ íŒŒì¼ì€ ì‚­ì œí•˜ì§€ ì•ŠìŒ, í´ë” ì •ë³´ë„ ì´ˆê¸°í™”)
                        const resetResult = await this.configManager.resetConfigOnly();
                        
                        // 2ë‹¨ê³„: í´ë” ì •ë³´ê°€ ì´ˆê¸°í™”ë˜ì—ˆìœ¼ë¯€ë¡œ UI ì—…ë°ì´íŠ¸
                        this.updateDirectoryStatus();
                        
                        // 3ë‹¨ê³„: UI ì—…ë°ì´íŠ¸
                        this.loadSettings();
                        await this.loadImageList();
                        this.updateStats();
                        
                        // ê²°ê³¼ ë©”ì‹œì§€ ìƒì„±
                        let message = resetResult.message;
                        
                        this.showNotification(message, 'success');
                        
                    } catch (error) {
                        console.error('ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜:', error);
                        this.showNotification('ì´ˆê¸°í™” ì¤‘ ì¼ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'warning');
                    } finally {
                        this.hideLoading();
                    }
                }
            }

            // config.json ìë™ ë¦¬ë¡œë“œ ì²˜ë¦¬
            async handleConfigReload() {
                try {
                    // UI ì „ì²´ ìƒˆë¡œê³ ì¹¨
                    this.loadSettings();
                    await this.loadImageList();
                    this.updateStats();
                    
                    this.showNotification('config.json íŒŒì¼ì´ ë³€ê²½ë˜ì–´ ìë™ìœ¼ë¡œ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ”„', 'info');
                } catch (error) {
                    console.error('config ë¦¬ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', error);
                    this.showNotification('config ìë™ ë¦¬ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }
        }

        // ì „ì—­ í•¨ìˆ˜ë“¤
        let app;

        function openFullSlide() {
            // í´ë” ì„ íƒ ì—¬ë¶€ í™•ì¸
            if (!app.configManager.hasDirectoryAccess()) {
                app.showNotification('ë¨¼ì € í”„ë¡œì íŠ¸ ë£¨íŠ¸í´ë”ì˜ images í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!', 'warning');
                return;
            }

            // ì´ë¯¸ì§€ ê°œìˆ˜ í™•ì¸
            const activeImages = app.configManager.getActiveImages();
            if (activeImages.length === 0) {
                app.showNotification('í‘œì‹œí•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!', 'warning');
                return;
            }

            // í˜„ì¬ ì„¤ì •ëœ ìŠ¬ë¼ì´ë“œ í¬ê¸° ê°€ì ¸ì˜¤ê¸°
            const config = app.configManager.getConfig();
            let width = 600;  // ê¸°ë³¸ê°’
            let height = 800;  // ê¸°ë³¸ê°’
            
            if (config && config.settings) {
                // containerWidthì™€ containerHeightì—ì„œ í”½ì…€ ê°’ ì¶”ì¶œ
                const containerWidth = config.settings.containerWidth;
                const containerHeight = config.settings.containerHeight;
                
                if (containerWidth && typeof containerWidth === 'string' && containerWidth.endsWith('px')) {
                    width = parseInt(containerWidth);
                }
                if (containerHeight && typeof containerHeight === 'string' && containerHeight.endsWith('px')) {
                    height = parseInt(containerHeight);
                }
                
                console.log('ğŸ–¥ï¸ ìƒˆ ì°½ í¬ê¸° ì„¤ì •:', { width, height, containerWidth, containerHeight });
            }
            
            // ì„¤ì •ì—ì„œ ë¸Œë¼ìš°ì € ì—¬ë°± ê°’ ê°€ì ¸ì˜¤ê¸°
            const settings = app.configManager.getSettings();
            const extraWidth = settings.extraWidth || 0;
            const extraHeight = settings.extraHeight || 40;
            
            const windowWidth = width + extraWidth;
            const windowHeight = height + extraHeight;
            
            // í™”ë©´ í¬ê¸°ë¥¼ ë„˜ì§€ ì•Šë„ë¡ ì œí•œ
            const maxWidth = Math.min(windowWidth, screen.availWidth - 100);
            const maxHeight = Math.min(windowHeight, screen.availHeight - 100);
            
            console.log('ğŸ“± ìµœì¢… ì°½ í¬ê¸°:', { 
                windowWidth: maxWidth, 
                windowHeight: maxHeight,
                containerSize: `${width}x${height}`
            });
            
            window.open('ìŠ¬ë¼ì´ë“œ.html', '_blank', `width=${maxWidth},height=${maxHeight},left=100,top=100`);
        }

        function saveToFile() {
            if (app) app.saveToFile();
        }

        function exportConfig() {
            if (app) app.exportConfig();
        }

        function importConfig() {
            if (app) app.importConfig();
        }

        function resetConfig() {
            if (app) app.resetConfig();
        }

        function refreshImages() {
            if (app) app.refreshImages();
        }

        function toggleHelp() {
            const helpMessage = document.getElementById('helpMessage');
            const helpBtn = document.getElementById('helpBtn');
            
            if (helpMessage.style.display === 'none') {
                helpMessage.style.display = 'block';
                helpBtn.innerHTML = '<span style="font-size: 16px;">â„¹ï¸</span> ì •ë³´ (ë‹«ê¸°)';
                helpBtn.title = 'ì‚¬ìš©ë²• ë° í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤ ìˆ¨ê¸°ê¸°';
            } else {
                helpMessage.style.display = 'none';
                helpBtn.innerHTML = '<span style="font-size: 16px;">â„¹ï¸</span> ì •ë³´';
                helpBtn.title = 'ì‚¬ìš©ë²• ë° í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤ ë³´ê¸°';
            }
        }

        // ì•± ì‹œì‘
        document.addEventListener('DOMContentLoaded', () => {
            app = new AdminApp();
        });

        // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ë©”ëª¨ë¦¬ ì •ë¦¬
        window.addEventListener('beforeunload', () => {
            if (app && app.configManager) {
                app.configManager.destroy();
            }
        });

        // ì—ëŸ¬ í•¸ë“¤ë§
        window.addEventListener('error', (event) => {
            console.error('ì „ì—­ ì˜¤ë¥˜:', event.error);
            if (app) {
                app.showNotification('ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        window.addEventListener('unhandledrejection', (event) => {
            console.error('ì²˜ë¦¬ë˜ì§€ ì•Šì€ í”„ë¼ë¯¸ìŠ¤ ê±°ë¶€:', event.reason);
        });
    </script>
</body>
</html>